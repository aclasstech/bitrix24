<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1305362664']= array(base64_decode('aXN'.'fc3Rya'.'W5n'),base64_decode('c3RydG9sb'.'3dlcg='.'='),base64_decode('aXNfYXJyYXk='),base64_decode('aXNfc3RyaW5n'),base64_decode('Z3pkZWNv'.'ZGU='),base64_decode('Ym'.'FzZTY0X2Rl'.'Y'.'2'.'9kZ'.'Q=='),base64_decode('dXJsZGVj'.'b2Rl'),base64_decode(''.'Y'.'XJyYXl'.'f'.'cm'.'V2ZXJ'.'zZQ'.'=='),base64_decode(''.'Z'.'3plbmNvZGU='),base64_decode('YmF'.'zZTY0X2V'.'u'.'Y'.'2'.'9kZQ'.'=='),base64_decode(''.'dX'.'JsZW5jb'.'2Rl'),base64_decode('Y'.'m'.'luMmh'.'le'.'A'.'=='),base64_decode(''.'aXNfYXJy'.'YXk='),base64_decode(''.'c3'.'Ry'.'dG9'.'sb3dlc'.'g=='),base64_decode('a'.'XNfY'.'XJyYXk='),base64_decode(''.'am'.'9pbg=='),base64_decode(''.'Zm5'.'tYXRjaA=='),base64_decode('c'.'mF'.'3dX'.'JsZGVjb2Rl'),base64_decode('c3Vi'.'c3Ry'),base64_decode('c3'.'V'.'ic3Ry'),base64_decode('c3RyX'.'3JlcGx'.'hY2U='),base64_decode('c'.'HJlZ19xdW90Z'.'Q=='),base64_decode('cHJ'.'lZ1'.'9tYXRj'.'a'.'A=='));if(!function_exists(__NAMESPACE__.'\\___268393548')){function ___268393548($_159948295){static $_1969165000= false; if($_1969165000 == false) $_1969165000=array(''.'Y'.'WN0aW9u','aW'.'50dmF'.'s','cGF0aA='.'=','Y29ud'.'GV4dA==',''.'a'.'2V'.'5cw==','cHJvY2Vzcw'.'==','Z'.'W5jb'.'2Rp'.'bmc=','cHJlZ'.'19'.'yZX'.'BsYWNl','cG'.'F0a'.'A==','Y2'.'9ud'.'GV4dA==','a2V'.'5'.'cw'.'==','cHJvY2'.'V'.'zcw==','ZW'.'5jb2Rpb'.'mc=','c'.'GF0dGVyb'.'g==','cH'.'J'.'lZ1'.'9tYXRjaA==','cGF0aA'.'==','Y29udGV4dA='.'=','a'.'2V5'.'cw==',''.'c'.'HJvY2'.'Vzcw'.'='.'=','ZW'.'5jb2R'.'pb'.'mc=','cGF0d'.'GV'.'y'.'bg='.'=','cG9z'.'dF9'.'hY3'.'R'.'pb24=','Y2'.'hlY2tfY'.'3NyZg==','cGF0aA==',''.'Y'.'29udG'.'V4dA==','a2'.'V'.'5cw==','cHJvY2V'.'z'.'cw='.'=','ZW5j'.'b2'.'Rpbmc=','c'.'GF0dGV'.'yb'.'g='.'=','YW'.'N'.'0aW9'.'u','YWN0'.'aW9u','Y'.'W'.'N0'.'aW9u','YWN0'.'a'.'W9'.'u','YWN0aW9u','YW'.'N0aW9u','cG9zdF9hY3Rp'.'b24=','Z'.'W5jb2Rpbm'.'c=','ZW'.'5'.'j'.'b'.'2Rpbmc'.'=','ZW5'.'jb2'.'Rpbmc=','ZW'.'5jb'.'2R'.'pbmc'.'=','ZW5jb2R'.'pbmc=','ZW'.'5j'.'b2'.'Rp'.'b'.'mc=','Z3'.'o=','YmFzZTY0','dXJs','aGV'.'4','Lg==','Lw'.'==','a'.'W5kZX'.'gucGhw','L2lu'.'ZGV4LnBocA='.'=','U0'.'N'.'SSVB'.'UX05BT'.'UU'.'=','L2luZGV4'.'LnBocA==','U'.'0NSS'.'VBUX'.'05BTUU=','U0N'.'SSVBUX05BTUU=','U0NSS'.'VBU'.'X05BTUU=',''.'fg==','fl4=','fg'.'==','XH'.'4=','JH4=');return base64_decode($_1969165000[$_159948295]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_670013831; protected $_1201419902; protected $_778294625; protected $_370380395; protected $_2105229885; public static function make(array $_2008855435):?static{ $_2008855435= static::prepareRuleParameters($_2008855435); return match($_2008855435[___268393548(0)]){ ___268393548(1) => new IntvalRule( $_2008855435[___268393548(2)], $_2008855435[___268393548(3)], $_2008855435[___268393548(4)], $_2008855435[___268393548(5)], $_2008855435[___268393548(6)]), ___268393548(7) => new PregReplaceRule( $_2008855435[___268393548(8)], $_2008855435[___268393548(9)], $_2008855435[___268393548(10)], $_2008855435[___268393548(11)], $_2008855435[___268393548(12)], $_2008855435[___268393548(13)]), ___268393548(14) => new PregMatchRule( $_2008855435[___268393548(15)], $_2008855435[___268393548(16)], $_2008855435[___268393548(17)], $_2008855435[___268393548(18)], $_2008855435[___268393548(19)], $_2008855435[___268393548(20)], $_2008855435[___268393548(21)]), ___268393548(22) => new CsrfRule( $_2008855435[___268393548(23)], $_2008855435[___268393548(24)], $_2008855435[___268393548(25)], $_2008855435[___268393548(26)], $_2008855435[___268393548(27)], $_2008855435[___268393548(28)],), default => null,};} protected static function prepareRuleParameters(array $_1333254861): array{ if($GLOBALS['____1305362664'][0]($_1333254861[___268393548(29)])){ $_1333254861[___268393548(30)]= $GLOBALS['____1305362664'][1]($_1333254861[___268393548(31)]);} elseif($GLOBALS['____1305362664'][2]($_1333254861[___268393548(32)])){ $_2112937911= $_1333254861[___268393548(33)]; $_1333254861[___268393548(34)]= $_2112937911[min(120,0,40)]; $_1333254861[___268393548(35)]= $_2112937911[round(0+0.33333333333333+0.33333333333333+0.33333333333333)];} $_1333254861[___268393548(36)]=!empty($_1333254861[___268393548(37)])? $_1333254861[___268393548(38)]:[]; if($GLOBALS['____1305362664'][3]($_1333254861[___268393548(39)])){ $_1333254861[___268393548(40)]=[$_1333254861[___268393548(41)]];} return $_1333254861;}  public function __construct($_670013831, $_1201419902, $_778294625, $_370380395, $_2105229885){ $this->_670013831= $_670013831; $this->_1201419902= $this->castContext($_1201419902); $this->_778294625= $this->castKeys($_778294625); $this->_370380395= $_370380395; $this->_2105229885= $_2105229885;} public function evaluateValue($_358973286){ if(!empty($this->_2105229885)){ foreach($this->_2105229885 as $_2057296749){ $_358973286= match($_2057296749){ 'gz' => $GLOBALS['____1305362664'][4]($_358973286), 'base64' => $GLOBALS['____1305362664'][5]($_358973286), 'url' => $GLOBALS['____1305362664'][6]($_358973286), 'hex' => hex2bin($_358973286)};}} $_1070227282= $this->evaluate($_358973286); if(!empty($this->_2105229885) && $_1070227282 instanceof ModifyResult){ $_1311980783= $_1070227282->getCleanValue(); foreach($GLOBALS['____1305362664'][7]($this->_2105229885) as $_2057296749){ $_1311980783= match($_2057296749){ ___268393548(42) => $GLOBALS['____1305362664'][8]($_1311980783), ___268393548(43) => $GLOBALS['____1305362664'][9]($_1311980783), ___268393548(44) => $GLOBALS['____1305362664'][10]($_1311980783), ___268393548(45) => $GLOBALS['____1305362664'][11]($_1311980783)};} $_1070227282= new ModifyResult($_1311980783);} return $_1070227282;} abstract public function evaluate($_358973286); protected function castContext($_1201419902){ if(!$GLOBALS['____1305362664'][12]($_1201419902)){ $_1201419902=[$_1201419902];} foreach($_1201419902 as $_715410928 => $_865722384){ $_1201419902[$_715410928]= $GLOBALS['____1305362664'][13]($_865722384);} return $_1201419902;} protected function castKeys($_778294625){ if(!$GLOBALS['____1305362664'][14]($_778294625)){ $_778294625=[$_778294625];} return $_778294625;} public function matchKey(array $_714089877): bool{ $_714089877= $GLOBALS['____1305362664'][15](___268393548(46), $_714089877); foreach($this->_778294625 as $_533166925){   if($GLOBALS['____1305362664'][16]($_533166925, $_714089877)){ return true;}} return false;}  public function matchPath($_955170256){ if($this->_670013831 === '*'){ return true;}  $_669389919= new Uri($_955170256); $_542727173= $_669389919->getPath(); $_542727173= $GLOBALS['____1305362664'][17]($_542727173);      if(str_ends_with($_542727173, ___268393548(47))){ $_542727173 .= ___268393548(48);} $_542727173= Path::normalize($_542727173);  $_498108447[]= $_542727173; if(str_ends_with($_542727173, ___268393548(49))){ $_498108447[]= $GLOBALS['____1305362664'][18]($_542727173,(1112/2-556),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___268393548(50)], ___268393548(51))){ $_498108447[]= $GLOBALS['____1305362664'][19]($_SERVER[___268393548(52)],(1472/2-736),-round(0+1.8+1.8+1.8+1.8+1.8));} if($_542727173 !== $_SERVER[___268393548(53)]){ $_498108447[]= $_SERVER[___268393548(54)];}  if(str_starts_with($this->_670013831, ___268393548(55))){ $_1911617644= $this->_670013831;} else{ $_1911617644= ___268393548(56). $GLOBALS['____1305362664'][20](___268393548(57), ___268393548(58), $GLOBALS['____1305362664'][21]($this->_670013831)). ___268393548(59);} foreach($_498108447 as $_355005251){ if($this->_670013831 === $_355005251 || $GLOBALS['____1305362664'][22]($_1911617644, $_355005251)){ return true;}} return false;}  public function getPath(){ return $this->_670013831;}  public function getContext(){ return $this->_1201419902;}  public function getKeys(){ return $this->_778294625;}  public function getProcess(){ return $this->_370380395;}}?>